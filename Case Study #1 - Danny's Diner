-- Q1.) What is the total amount each customer spent at the restaurant?
SELECT s.customer_id, SUM(m.price) AS total_amount_spent
FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id
GROUP BY s.customer_id

-- Q2.) How many days has each customer visited the restaurant?
SELECT  customer_id, COUNT (DISTINCT order_date) As no_of_visits
FROM sales
GROUP BY customer_id

-- Q3.) What was the first item from the menu purchased by each customer?
SELECT customer_id, product_name 
FROM
(SELECT customer_id, order_date, s.product_id, product_name, price,
DENSE_RANK() OVER (ORDER BY order_date ASC) AS item_first_ordered
FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id) temp
WHERE item_first_ordered = 1


-- Q4.) What is the most purchased item on the menu and how many times was it purchased by all customers?
SELECT customer_id, COUNT(product_name) AS no_of_times_of_purchase FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id
WHERE product_name = (SELECT product_name
FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id
GROUP BY product_name
HAVING COUNT(product_name) > 5 )
GROUP BY customer_id
