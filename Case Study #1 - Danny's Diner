-- Q1.) What is the total amount each customer spent at the restaurant?
SELECT s.customer_id, SUM(m.price) AS total_amount_spent
FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id
GROUP BY s.customer_id

Answer: Customer A spent $76, Customer B spent $74 and Customer C spent $36

-- Q2.) How many days has each customer visited the restaurant?
SELECT  customer_id, COUNT (DISTINCT order_date) As no_of_visits
FROM sales
GROUP BY customer_id

Answer: Customer A visted 4 times, Customer B visited 6 times and Customer C visited 2 times

-- Q3.) What was the first item from the menu purchased by each customer?
SELECT customer_id, product_name 
FROM
(SELECT customer_id, order_date, s.product_id, product_name, price,
DENSE_RANK() OVER (PARTITION BY customer_id ORDER BY order_date ASC) AS item_first_ordered
FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id) temp
WHERE item_first_ordered = 1
GROUP BY customer_id, product_name

Answer: Customer A's first order are curry and sushi, Customer B's first order is curry, Customer C's first order is ramen

-- Q4.) What is the most purchased item on the menu and how many times was it purchased by all customers?
SELECT TOP 1 COUNT(product_name) AS most_purchased_item, product_name
FROM sales s
INNER JOIN menu m
ON s.product_id = m.product_id
GROUP BY product_name
ORDER BY COUNT(product_name) DESC

Answer: The most purchased item on the menu is ramen which is 8 times
